# é¡¹ç›®æ–‡ä»¶ç´¢å¼•

## ğŸ“ é¡¹ç›®ç»“æ„æ¦‚è§ˆ

```
backed/
â”œâ”€â”€ ğŸ“„ æ–‡æ¡£æ–‡ä»¶
â”‚   â”œâ”€â”€ README.md                    # é¡¹ç›®å®Œæ•´è¯´æ˜æ–‡æ¡£
â”‚   â”œâ”€â”€ å¿«é€Ÿå¯åŠ¨æŒ‡å—.md              # æ–°æ‰‹å¿«é€Ÿå…¥é—¨
â”‚   â”œâ”€â”€ APIæµ‹è¯•æ–‡æ¡£.md              # APIæ¥å£æµ‹è¯•ç¤ºä¾‹
â”‚   â”œâ”€â”€ é¡¹ç›®å®Œæˆæƒ…å†µè¯´æ˜.md          # åŠŸèƒ½å®Œæˆæ¸…å•
â”‚   â”œâ”€â”€ é¡¹ç›®æ–‡ä»¶ç´¢å¼•.md              # æœ¬æ–‡ä»¶
â”‚   â””â”€â”€ init.sql                    # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ“‚ cmd/                         # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ main.go                     # ä¸»ç¨‹åºå…¥å£
â”‚
â”œâ”€â”€ ğŸ“‚ config/                      # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ config.yaml                 # åº”ç”¨é…ç½®ï¼ˆæ•°æ®åº“ã€JWTã€åŠ å¯†ç­‰ï¼‰
â”‚
â”œâ”€â”€ ğŸ“‚ internal/                    # å†…éƒ¨åŒ…ï¼ˆæ ¸å¿ƒä¸šåŠ¡ï¼‰
â”‚   â”œâ”€â”€ ğŸ“‚ api/                     # APIå±‚
â”‚   â”‚   â”œâ”€â”€ routes.go              # è·¯ç”±æ³¨å†Œ
â”‚   â”‚   â””â”€â”€ ğŸ“‚ handler/            # è¯·æ±‚å¤„ç†å™¨
â”‚   â”‚       â”œâ”€â”€ user_handler.go           # ç”¨æˆ·æ¥å£
â”‚   â”‚       â”œâ”€â”€ admin_handler.go          # ç®¡ç†å‘˜æ¥å£
â”‚   â”‚       â”œâ”€â”€ consultation_handler.go   # é—®è¯Šæ¥å£
â”‚   â”‚       â”œâ”€â”€ record_handler.go         # ç—…å†æ¥å£
â”‚   â”‚       â”œâ”€â”€ notification_handler.go   # é€šçŸ¥æ¥å£
â”‚   â”‚       â”œâ”€â”€ file_handler.go           # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚       â””â”€â”€ key_handler.go            # å¯†é’¥ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ service/                 # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ user_service.go               # ç”¨æˆ·ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ admin_service.go              # ç®¡ç†å‘˜ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ consultation_service.go       # é—®è¯Šä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ record_service.go             # ç—…å†ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ notification_service.go       # é€šçŸ¥ä¸šåŠ¡é€»è¾‘
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ repository/              # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”œâ”€â”€ user_repository.go                    # ç”¨æˆ·æ•°æ®è®¿é—®
â”‚   â”‚   â”œâ”€â”€ doctor_application_repository.go      # åŒ»ç”Ÿç”³è¯·æ•°æ®è®¿é—®
â”‚   â”‚   â”œâ”€â”€ login_log_repository.go               # ç™»å½•æ—¥å¿—æ•°æ®è®¿é—®
â”‚   â”‚   â”œâ”€â”€ consultation_repository.go            # é—®è¯Šæ•°æ®è®¿é—®
â”‚   â”‚   â”œâ”€â”€ record_repository.go                  # ç—…å†æ•°æ®è®¿é—®
â”‚   â”‚   â””â”€â”€ notification_repository.go            # é€šçŸ¥æ•°æ®è®¿é—®
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ model/                   # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ models.go                      # æ‰€æœ‰æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ middleware/              # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ auth.go                        # JWTè®¤è¯ & CORS
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ crypto/                  # å›½å¯†åŠ å¯†
â”‚       â””â”€â”€ crypto.go                      # SM2/SM3/SM4å®ç°
â”‚
â”œâ”€â”€ ğŸ“‚ pkg/                         # å…¬å…±åŒ…
â”‚   â”œâ”€â”€ ğŸ“‚ config/                  # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ config.go
â”‚   â”œâ”€â”€ ğŸ“‚ database/                # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â””â”€â”€ database.go
â”‚   â””â”€â”€ ğŸ“‚ utils/                   # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ jwt.go                         # JWTå·¥å…·
â”‚       â””â”€â”€ response.go                    # ç»Ÿä¸€å“åº”
â”‚
â”œâ”€â”€ go.mod                          # Goæ¨¡å—ä¾èµ–
â””â”€â”€ go.sum                          # ä¾èµ–æ ¡éªŒå’Œ

```

## ğŸ“š æ–‡æ¡£æŒ‡å—

### æ–°æ‰‹å…¥é—¨
1. **é¦–å…ˆé˜…è¯»**: [å¿«é€Ÿå¯åŠ¨æŒ‡å—.md](./å¿«é€Ÿå¯åŠ¨æŒ‡å—.md)
   - ç¯å¢ƒå‡†å¤‡
   - æ•°æ®åº“åˆå§‹åŒ–
   - é…ç½®ä¿®æ”¹
   - å¯åŠ¨è¿è¡Œ

2. **ç„¶åé˜…è¯»**: [README.md](./README.md)
   - é¡¹ç›®æ¦‚è¿°
   - æŠ€æœ¯æ ˆ
   - æ ¸å¿ƒåŠŸèƒ½
   - APIæ–‡æ¡£
   - é…ç½®è¯´æ˜

### å¼€å‘è€…æŒ‡å—
1. **å¼€å‘è§„èŒƒ**: [README.md](./README.md) ä¸­çš„"å¼€å‘æŒ‡å—"ç« èŠ‚
2. **APIæµ‹è¯•**: [APIæµ‹è¯•æ–‡æ¡£.md](./APIæµ‹è¯•æ–‡æ¡£.md)
3. **åŠŸèƒ½æ¸…å•**: [é¡¹ç›®å®Œæˆæƒ…å†µè¯´æ˜.md](./é¡¹ç›®å®Œæˆæƒ…å†µè¯´æ˜.md)

### æ•°æ®åº“ç›¸å…³
- **åˆå§‹åŒ–è„šæœ¬**: [init.sql](./init.sql)
- **æ•°æ®æ¨¡å‹**: [internal/model/models.go](./internal/model/models.go)

## ğŸ¯ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### å…¥å£æ–‡ä»¶
- **[cmd/main.go](./cmd/main.go)**
  - åº”ç”¨å¯åŠ¨å…¥å£
  - åˆå§‹åŒ–é…ç½®
  - åˆå§‹åŒ–å›½å¯†åŠ å¯†
  - åˆå§‹åŒ–æ•°æ®åº“
  - æ³¨å†Œè·¯ç”±
  - å¯åŠ¨æœåŠ¡å™¨

### é…ç½®æ–‡ä»¶
- **[config/config.yaml](./config/config.yaml)**
  - æœåŠ¡å™¨é…ç½®ï¼ˆç«¯å£ã€æ¨¡å¼ï¼‰
  - æ•°æ®åº“é…ç½®
  - Redisé…ç½®
  - JWTé…ç½®
  - å›½å¯†åŠ å¯†é…ç½®
  - æ–‡ä»¶ä¸Šä¼ é…ç½®

### è·¯ç”±æ–‡ä»¶
- **[internal/api/routes.go](./internal/api/routes.go)**
  - æ³¨å†Œæ‰€æœ‰APIè·¯ç”±
  - ä¸­é—´ä»¶é…ç½®
  - è·¯ç”±åˆ†ç»„

### å›½å¯†åŠ å¯†
- **[internal/crypto/crypto.go](./internal/crypto/crypto.go)**
  - SM3å“ˆå¸Œç®—æ³•
  - SM4å¯¹ç§°åŠ å¯†/è§£å¯†
  - SM2éå¯¹ç§°åŠ å¯†/è§£å¯†
  - å¯†é’¥åˆå§‹åŒ–

### æ•°æ®æ¨¡å‹
- **[internal/model/models.go](./internal/model/models.go)**
  - Userï¼ˆç”¨æˆ·ï¼‰
  - DoctorApplicationï¼ˆåŒ»ç”Ÿç”³è¯·ï¼‰
  - Consultationï¼ˆé—®è¯Šï¼‰
  - MedicalRecordï¼ˆç—…å†ï¼‰
  - Notificationï¼ˆé€šçŸ¥ï¼‰
  - LoginLogï¼ˆç™»å½•æ—¥å¿—ï¼‰

## ğŸ”§ ä¸»è¦åŠŸèƒ½æ¨¡å—

### 1. ç”¨æˆ·æ¨¡å—
**Handler**: [internal/api/handler/user_handler.go](./internal/api/handler/user_handler.go)
**Service**: [internal/service/user_service.go](./internal/service/user_service.go)
**Repository**: [internal/repository/user_repository.go](./internal/repository/user_repository.go)

åŠŸèƒ½ï¼š
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- å¯†ç ä¿®æ”¹
- ç”³è¯·æˆä¸ºåŒ»ç”Ÿ
- åŒ»ç”Ÿåˆ—è¡¨æŸ¥è¯¢

### 2. ç®¡ç†å‘˜æ¨¡å—
**Handler**: [internal/api/handler/admin_handler.go](./internal/api/handler/admin_handler.go)
**Service**: [internal/service/admin_service.go](./internal/service/admin_service.go)

åŠŸèƒ½ï¼š
- å®¡æ ¸åŒ»ç”Ÿç”³è¯·
- ç”¨æˆ·ç®¡ç†
- ç™»å½•æ—¥å¿—æŸ¥è¯¢

### 3. é—®è¯Šæ¨¡å—
**Handler**: [internal/api/handler/consultation_handler.go](./internal/api/handler/consultation_handler.go)
**Service**: [internal/service/consultation_service.go](./internal/service/consultation_service.go)
**Repository**: [internal/repository/consultation_repository.go](./internal/repository/consultation_repository.go)

åŠŸèƒ½ï¼š
- åˆ›å»ºé—®è¯Š
- é—®è¯Šåˆ—è¡¨
- åŒ»ç”Ÿæ¥è¯Š
- å®Œæˆé—®è¯Š

### 4. ç—…å†æ¨¡å—
**Handler**: [internal/api/handler/record_handler.go](./internal/api/handler/record_handler.go)
**Service**: [internal/service/record_service.go](./internal/service/record_service.go)
**Repository**: [internal/repository/record_repository.go](./internal/repository/record_repository.go)

åŠŸèƒ½ï¼š
- ç—…å†æŸ¥è¯¢
- æ•°æ®åŠ å¯†/è§£å¯†
- å®Œæ•´æ€§éªŒè¯

### 5. é€šçŸ¥æ¨¡å—
**Handler**: [internal/api/handler/notification_handler.go](./internal/api/handler/notification_handler.go)
**Service**: [internal/service/notification_service.go](./internal/service/notification_service.go)
**Repository**: [internal/repository/notification_repository.go](./internal/repository/notification_repository.go)

åŠŸèƒ½ï¼š
- é€šçŸ¥åˆ—è¡¨
- æœªè¯»ç»Ÿè®¡
- æ ‡è®°å·²è¯»

## ğŸ”‘ å·¥å…·ç±»æ–‡ä»¶

### JWTè®¤è¯
- **[pkg/utils/jwt.go](./pkg/utils/jwt.go)**
  - Tokenç”Ÿæˆ
  - Tokenè§£æ
  - Claimsç»“æ„

### ç»Ÿä¸€å“åº”
- **[pkg/utils/response.go](./pkg/utils/response.go)**
  - Successå“åº”
  - Errorå“åº”
  - å„ç§HTTPçŠ¶æ€ç å°è£…

### æ•°æ®åº“è¿æ¥
- **[pkg/database/database.go](./pkg/database/database.go)**
  - æ•°æ®åº“åˆå§‹åŒ–
  - è¿æ¥æ± é…ç½®
  - è·å–DBå®ä¾‹

### é…ç½®åŠ è½½
- **[pkg/config/config.go](./pkg/config/config.go)**
  - é…ç½®ç»“æ„å®šä¹‰
  - YAMLæ–‡ä»¶åŠ è½½
  - é…ç½®éªŒè¯

## ğŸ“‹ ä¸­é—´ä»¶

### è®¤è¯ä¸­é—´ä»¶
- **[internal/middleware/auth.go](./internal/middleware/auth.go)**
  - JWT TokenéªŒè¯
  - ç”¨æˆ·ä¿¡æ¯æå–
  - CORSé…ç½®

## ğŸ—„ï¸ æ•°æ®åº“

### åˆå§‹åŒ–è„šæœ¬
- **[init.sql](./init.sql)**
  - åˆ›å»ºæ•°æ®åº“
  - åˆ›å»ºæ‰€æœ‰è¡¨
  - åˆ›å»ºç´¢å¼•
  - æ’å…¥é»˜è®¤ç®¡ç†å‘˜

### æ•°æ®è¡¨æ¸…å•
1. SM_user - ç”¨æˆ·è¡¨
2. SM_doctor_application - åŒ»ç”Ÿç”³è¯·è¡¨
3. SM_login_log - ç™»å½•æ—¥å¿—è¡¨
4. SM_consultation - é—®è¯Šè®°å½•è¡¨
5. SM_consultation_message - é—®è¯Šæ¶ˆæ¯è¡¨
6. SM_medical_record - ç”µå­ç—…å†è¡¨
7. SM_record_access_log - ç—…å†è®¿é—®æ—¥å¿—è¡¨
8. SM_notification - ç³»ç»Ÿé€šçŸ¥è¡¨

## ğŸ“ å¿«é€ŸæŸ¥æ‰¾

### éœ€è¦ä¿®æ”¹é…ç½®ï¼Ÿ
â†’ [config/config.yaml](./config/config.yaml)

### éœ€è¦æ·»åŠ æ–°æ¥å£ï¼Ÿ
1. å®šä¹‰æ•°æ®æ¨¡å‹: [internal/model/models.go](./internal/model/models.go)
2. åˆ›å»ºRepository: [internal/repository/](./internal/repository/)
3. åˆ›å»ºService: [internal/service/](./internal/service/)
4. åˆ›å»ºHandler: [internal/api/handler/](./internal/api/handler/)
5. æ³¨å†Œè·¯ç”±: [internal/api/routes.go](./internal/api/routes.go)

### éœ€è¦ä¿®æ”¹åŠ å¯†é€»è¾‘ï¼Ÿ
â†’ [internal/crypto/crypto.go](./internal/crypto/crypto.go)

### éœ€è¦ä¿®æ”¹å“åº”æ ¼å¼ï¼Ÿ
â†’ [pkg/utils/response.go](./pkg/utils/response.go)

### éœ€è¦è°ƒè¯•JWTï¼Ÿ
â†’ [pkg/utils/jwt.go](./pkg/utils/jwt.go)
â†’ [internal/middleware/auth.go](./internal/middleware/auth.go)

### éœ€è¦æµ‹è¯•APIï¼Ÿ
â†’ [APIæµ‹è¯•æ–‡æ¡£.md](./APIæµ‹è¯•æ–‡æ¡£.md)

### éœ€è¦éƒ¨ç½²ï¼Ÿ
â†’ [README.md](./README.md) ä¸­çš„"ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²"ç« èŠ‚

## ğŸ†˜ å¸¸è§é—®é¢˜

### æ‰¾ä¸åˆ°æŸä¸ªåŠŸèƒ½çš„ä»£ç ï¼Ÿ
1. å…ˆçœ‹æœ¬æ–‡æ¡£çš„"æ ¸å¿ƒæ–‡ä»¶è¯´æ˜"
2. æ ¹æ®åŠŸèƒ½æ¨¡å—æ‰¾åˆ°å¯¹åº”çš„Handler
3. ä»Handlerè¿½è¸ªåˆ°Serviceå’ŒRepository

### æƒ³äº†è§£æ•°æ®åº“ç»“æ„ï¼Ÿ
1. æŸ¥çœ‹ [init.sql](./init.sql)
2. æŸ¥çœ‹ [internal/model/models.go](./internal/model/models.go)

### æƒ³çŸ¥é“æŸä¸ªæ¥å£å¦‚ä½•è°ƒç”¨ï¼Ÿ
1. æŸ¥çœ‹ [APIæµ‹è¯•æ–‡æ¡£.md](./APIæµ‹è¯•æ–‡æ¡£.md)
2. æŸ¥çœ‹å¯¹åº”çš„Handleræ–‡ä»¶

### æƒ³äº†è§£æ•´ä½“æ¶æ„ï¼Ÿ
1. æŸ¥çœ‹ [README.md](./README.md)
2. æŸ¥çœ‹ [é¡¹ç›®å®Œæˆæƒ…å†µè¯´æ˜.md](./é¡¹ç›®å®Œæˆæƒ…å†µè¯´æ˜.md)

## ğŸ“ è·å–å¸®åŠ©

1. **é˜…è¯»æ–‡æ¡£**: ä¼˜å…ˆæŸ¥çœ‹æœ¬ç›®å½•ä¸‹çš„å„ç±»æ–‡æ¡£
2. **æŸ¥çœ‹ä»£ç **: ä»£ç æ³¨é‡Šè¯¦ç»†ï¼Œå¯ç›´æ¥é˜…è¯»
3. **æäº¤Issue**: å¦‚å‘ç°é—®é¢˜ï¼Œè¯·æäº¤Issue
4. **è”ç³»å¼€å‘è€…**: é€šè¿‡é¡¹ç›®ä»“åº“è”ç³»

## ğŸ“ å­¦ä¹ å»ºè®®

### åˆå­¦è€…
1. å…ˆé˜…è¯» [å¿«é€Ÿå¯åŠ¨æŒ‡å—.md](./å¿«é€Ÿå¯åŠ¨æŒ‡å—.md)
2. è¿è¡Œé¡¹ç›®ï¼Œä½¿ç”¨ [APIæµ‹è¯•æ–‡æ¡£.md](./APIæµ‹è¯•æ–‡æ¡£.md) æµ‹è¯•æ¥å£
3. é˜…è¯» [cmd/main.go](./cmd/main.go) äº†è§£å¯åŠ¨æµç¨‹
4. æŒ‰æ¨¡å—é€ä¸ªå­¦ä¹ Handlerã€Serviceã€Repository

### æœ‰ç»éªŒçš„å¼€å‘è€…
1. ç›´æ¥æŸ¥çœ‹ [README.md](./README.md) äº†è§£æ¶æ„
2. æŸ¥çœ‹ [é¡¹ç›®å®Œæˆæƒ…å†µè¯´æ˜.md](./é¡¹ç›®å®Œæˆæƒ…å†µè¯´æ˜.md) äº†è§£åŠŸèƒ½
3. æ ¹æ®éœ€æ±‚ç›´æ¥å®šä½åˆ°å¯¹åº”æ¨¡å—çš„ä»£ç 
4. æ ¹æ® [APIæµ‹è¯•æ–‡æ¡£.md](./APIæµ‹è¯•æ–‡æ¡£.md) è¿›è¡Œæ¥å£å¯¹æ¥

---

**æç¤º**: æœ¬æ–‡æ¡£ä¼šéšç€é¡¹ç›®æ›´æ–°è€Œæ›´æ–°ï¼Œå»ºè®®æ”¶è—å¤‡ç”¨ï¼
