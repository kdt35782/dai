# 快速启动指南

## 第一步：安装MySQL

确保你的系统已安装MySQL 8.0或更高版本。

### Windows用户
1. 下载MySQL安装包：https://dev.mysql.com/downloads/mysql/
2. 运行安装程序并设置root密码
3. 记住你的MySQL密码，后面配置时会用到

### Linux用户
```bash
sudo apt-get update
sudo apt-get install mysql-server
```

## 第二步：初始化数据库

1. 打开MySQL客户端：
```bash
mysql -u root -p
```

2. 执行数据库初始化脚本：
```sql
source d:/基于国密加密的网上看诊系统/backed/init.sql
```

或者直接在命令行执行：
```bash
mysql -u root -p < d:/基于国密加密的网上看诊系统/backed/init.sql
```

执行成功后，会创建数据库`SM`和所有必需的表，并创建一个默认管理员账号。

## 第三步：配置后端

1. 进入backed目录
```bash
cd d:/基于国密加密的网上看诊系统/backed
```

2. 编辑配置文件 `config/config.yaml`
```yaml
database:
  host: localhost
  port: 3306
  username: root
  password: your_mysql_password  # 修改为你的MySQL密码
  database: SM
```

**重要**：还需要修改加密密钥（生产环境必须修改）：
```yaml
crypto:
  sm4_key: 请生成一个32位的16进制字符串
jwt:
  secret: 请生成一个复杂的密钥字符串
```

## 第四步：安装Go依赖

如果你的系统还没有安装Go语言环境，需要先安装：

### Windows用户
1. 下载Go：https://golang.org/dl/
2. 运行安装程序
3. 打开新的终端窗口验证安装：
```bash
go version
```

### 安装项目依赖
```bash
go mod tidy
```

## 第五步：运行后端服务

```bash
go run cmd/main.go
```

看到以下输出表示启动成功：
```
Crypto initialized successfully
Database connected successfully
Server is running on :3000
Environment: debug
```

## 第六步：测试API

### 使用默认管理员账号登录

**账号信息：**
- 用户名：admin
- 密码：Admin123!@#

**登录请求：**
```bash
curl -X POST http://localhost:3000/api/user/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "Admin123!@#"
  }'
```

或使用Postman等工具：
- URL: `http://localhost:3000/api/user/login`
- Method: POST
- Body (JSON):
```json
{
  "username": "admin",
  "password": "Admin123!@#"
}
```

成功后会返回token，后续请求需要在Header中携带：
```
Authorization: Bearer <token>
```

## 第七步：注册普通用户

```bash
curl -X POST http://localhost:3000/api/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "Test123!@#",
    "email": "test@example.com",
    "phone": "13800138000"
  }'
```

注意：
- 密码需要在前端使用SM3加密后再发送（这里为了演示使用明文）
- 实际使用时前端会自动处理加密

## 第八步：前后端联调

如果你有前端项目，需要修改前端配置指向后端地址：

1. 找到前端的API配置文件
2. 将baseURL改为 `http://localhost:3000`
3. 启动前端项目

## 常见问题

### 1. 端口被占用
如果3000端口已被占用，修改 `config/config.yaml` 中的端口号：
```yaml
server:
  port: 8080  # 改为其他端口
```

### 2. 数据库连接失败
检查：
- MySQL服务是否运行
- 用户名密码是否正确
- 数据库SM是否已创建

### 3. Go命令不存在
确保Go已正确安装并添加到系统PATH环境变量。

### 4. 依赖下载慢
可以配置Go代理：
```bash
go env -w GOPROXY=https://goproxy.cn,direct
```

## 下一步

- 查看 `README.md` 了解完整的API文档
- 查看 `开发文档.md` 了解详细的接口规范
- 开始开发你的前端应用！

## 安全提醒

⚠️ **生产环境部署前必须：**
1. 修改默认管理员密码
2. 更换crypto配置中的sm4_key
3. 更换jwt配置中的secret
4. 将server.mode改为release
5. 配置HTTPS
6. 限制数据库访问权限
